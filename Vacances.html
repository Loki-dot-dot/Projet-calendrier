<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vacances</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" >
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</head>
<style>
    html{
        height: 100%;
        }
    body {
        min-height: 100%;
        display: flex;
        flex-direction: column;
        }
    footer{
        margin-top: auto;
        }
    body {
        background-image: url('images/pexels-pixabay-207580.jpg');
        background-size: cover;
        background-attachment: fixed;
        background-repeat: no-repeat;
        background-position: center;
    }
    #table {
        margin: 50px auto;
        border-collapse: separate;
        width: 80%;
        background-color: rgba(255, 255, 255, 0.9);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        padding: 10px;
        border-radius: 10px;
    }
    .bg-past {
        background-color: lightgray;
    }

    .bg-today-ongoing {
        background-color: lightgreen;
    }

    .bg-upcoming {
        background-color: orange;
    }


</style>
<script>
// Helper: format Date object to YYYY-MM-DD string
function formatDate(d) {
  return new Date(d).toISOString().split('T')[0];
}

// Helper: get start date of event (single date or range start)
function getStartDate(event) {
  if (typeof event.date === 'string') return new Date(event.date);
  if (event.date.debut) return new Date(event.date.debut);
  return null;
}

// Helper: get end date of event (single date or range end)
function getEndDate(event) {
  if (typeof event.date === 'string') return new Date(event.date);
  if (event.date.fin) return new Date(event.date.fin);
  return null;
}

// Main function to assign CSS classes
function getEventStatusClasses(events) {
  const today = new Date();
  const todayStr = formatDate(today);

  // Find all future events (startDate > today)
  const futureEvents = events
    .map((event, idx) => ({ event, idx, startDate: getStartDate(event) }))
    .filter(({ startDate }) => startDate && formatDate(startDate) > todayStr);

  // Sort future events ascending by startDate
  futureEvents.sort((a, b) => a.startDate - b.startDate);

  // Closest upcoming event index
  const closestUpcomingIdx = futureEvents.length ? futureEvents[0].idx : null;

  // Assign classes
  return events.map((event, idx) => {
    const startDate = getStartDate(event);
    const endDate = getEndDate(event);
    const startStr = startDate ? formatDate(startDate) : null;
    const endStr = endDate ? formatDate(endDate) : null;

    // Past
    if (endStr && endStr < todayStr) return 'bg-past';
    if (!endStr && startStr && startStr < todayStr) return 'bg-past';

    // Today / ongoing
    if (startStr === todayStr) return 'bg-today-ongoing';
    if (endStr && startStr && todayStr >= startStr && todayStr <= endStr) return 'bg-today-ongoing';

    // Upcoming: only closest upcoming event
    if (idx === closestUpcomingIdx) return 'bg-upcoming';

    return '';
  });
}

// Fetch the JSON file and render events inside a container element
async function loadAndRenderEvents(containerSelector) {
  const container = document.querySelector(containerSelector);
  if (!container) {
    console.error('Container element not found');
    return;
  }

  try {
    const response = await fetch('Dates.json');
    if (!response.ok) throw new Error('Failed to fetch Dates.json');

    const events = await response.json();
    const classes = getEventStatusClasses(events);

    container.innerHTML = ''; // clear loading or old content

    events.forEach((event, i) => {
      const el = document.createElement('div');
      let dateDisplay = '';
      if (typeof event.date === 'string') {
        dateDisplay = event.date;
      } else {
        dateDisplay = `${event.date.debut} to ${event.date.fin}`;
      }
      el.textContent = `${event.evenement} (${dateDisplay})`;
      if (classes[i]) el.classList.add(classes[i]);
      container.appendChild(el);
    });

  } catch (error) {
    container.textContent = `Error loading events: ${error.message}`;
    console.error(error);
  }
}

</script>
<body>
       <nav class="navbar navbar-expand-lg bg-secondary position-sticky z-3 top-0 ">
        <div class="container-fluid">
            <div class="navbar-brand text-light">
                <img src="images/Capture d'écran 2025-09-24 101405.png" alt="Logo" style="width:40px;" class="rounded-pill text-secondary me-2">Calendrier OFPPT
            </div>
            <ul class="navbar-nav">
                <li class="nav-item"><a href="index.html"><button class="btn btn-secondary">Accueil</button></a></li>
                <li class="nav-item"><a href="Vacances.html"><button class="btn btn-secondary">Vacances</button></a></li>
                <li class="nav-item"><a href="liste_efm(f).html"><button class="btn btn-secondary">EFM/EFF</button></a></li>
                <div class="dropdown">
                    <button class="btn btn-secondary dropdown-toggle" type="button" data-bs-toggle="dropdown">Choisir un groupe</button>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="#">​ᴅᴇᴠ​ DEV201</a></li>
                            <li><a class="dropdown-item" href="#">​ᴅᴇᴠ DEV202</a></li>
                            <li><a class="dropdown-item" href="#">ᴅᴇᴠ DEV203</a></li>
                        </ul>
                </div>
            </ul>
        </div>
    </nav>
    <div id="events-container">
    <table border="black" cellspacing="0" id="table">
        <tr>
            <th>Evenement</th>
            <th>Nombre de Jours</th>
            <th>Date de vacances</th>
        </tr>
        <tr id="event 1">
            <td>Aid Al Mawlid</td>
            <td>02</td>
            <td>12 et 13 Rabii I 1447</td>
        </tr>
        <tr id="event 2">
            <td>La Marche Verte	</td>
            <td>01</td>
            <td>Jeudi 06 Novembre 2025</td>
        </tr>
        <tr id="event 3">
            <td>Fête de l'Indépendance</td>
            <td>01</td>
            <td>Mardi 18 Novembre 2025</td>
        </tr>
        <tr id="event 4">
            <td>Vacances du 1er trimestre</td>
            <td>08</td>
            <td>Du Lundi 08 Décembre 2024 au Lundi 15 Décembre 2025</td>
        </tr>
        <tr id="event 5">
            <td> Nouvel an	</td>
            <td> 01 </td>
            <td> Jeudi 01 Janvier 2026 </td>
        </tr>
        <tr id="event 6">
            <td>Manifeste de l'indépendance	</td>
            <td>01</td>
            <td>Dimanche 11 Janvier 2026</td>
        </tr>
        <tr id="event 7">
            <td>Nouvel an Amazigh</td>
            <td>01</td>
            <td>Mercredi 14 Janvier 2026</td>
        </tr>
        <tr id="event 8">
            <td>Vacances de la mi-année de formation</td>
            <td>08	</td>
            <td>Du Lundi 26 Janvier 2026 au Lundi 2 Février 2026</td>
        </tr>
        <tr id="event 9">
            <td>Vacances du 2ème trimestre	</td>
            <td> 08 </td>
            <td> Du Lundi 16 Mars 2026 au Lundi 23 Mars 2026</td>
        </tr>
        <tr id="event 10">
            <td>Aid Al Fitr	</td>
            <td>03 ou 04</td>
            <td>Du 29 Ramadan au 02 Chaoual 1447</td>
        </tr>
        <tr id="event 11">
            <td>Fête du travail	</td>
            <td> 01	</td>
            <td>Vendredi 01 Mai 2026</td>
        </tr>
        <tr id="event 12">
            <td>Vacances du 3ème trimestre	</td>
            <td>08</td>
            <td>Du Lundi 04 Mai 2026 au Lundi 11 Mai 2026</td>
        </tr>
        <tr id="event 13">
            <td>َAid Adha</td>
            <td>04</td>
            <td>Du 08 au 11 dhul Hijja 1447</td>
        </tr>
        <tr id="event 14">
            <td>1er Muharram	</td>
            <td>01</td>
            <td>1er Muharram 1448</td>
        </tr>
    </table>
    </div>
    <footer class="container-fluid bg-secondary text-light text-center p-3">© 2025-2026 Calendrier OFPPT- Tous droits réservés.<a class="nav-link text-light fixed-bottom" href="#">À propos</a></li></footer>
<script>loadAndRenderEvents('#events-container');</script>
</body>
</body>
</html>